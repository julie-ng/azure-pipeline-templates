parameters:
  - name: serviceConnectionName
    type: string
    default: ''

  - name: azureContainerRegistry
    type: string
    default: ''

  - name: imageName # e.g. namespace/myimage
    type: string
    default: ''

  - name: tagsAsMultilineString
    type: string
    default: |
      dev

steps:

- task: Docker@2
  displayName: Login to ACR
  inputs:
    command: login
    containerRegistry: ${{ parameters.serviceConnectionName }}

- task: Docker@2
  displayName: Build and Push
  inputs:
    command: buildAndPush
    repository: ${{ parameters.imageName }}
    tags: ${{ parameters.tagsAsMultilineString }}

- task: Docker@2
  displayName: Logout of ACR
  inputs:
    command: logout
    containerRegistry: ${{ parameters.serviceConnectionName }}
